import random
import string
from typing import Dict, Any

def random_name(length=6):
    """Generate a random uppercase name starting with P."""
    return "P" + ''.join(random.choice(string.ascii_uppercase) for _ in range(length-1))


def generate_pan(firstname, lastname):
    """
    Generate a PAN number where:
    - 4th char = 'P'
    - 5th char = first letter of lastname
    """
    part1 = ''.join(random.choice(string.ascii_uppercase) for _ in range(3))   # first 3 letters
    part2 = "P"                                                               # FIXED requirement
    part3 = lastname[0].upper()                                               # first letter of last name
    part4 = ''.join(random.choice(string.digits) for _ in range(4))           # digits
    part5 = random.choice(string.ascii_uppercase)                              # ending letter
    return part1 + part2 + part3 + part4 + part5


def generate_cif_entry(RRN, r_code) -> Dict[str, Any]:

    firstname = random_name(7)        # always starts with P
    lastname = random_name(8)         # random, does NOT need P
    pancard = generate_pan(firstname, lastname)

    return {
        "RRN": RRN,
        "R_CODE": r_code,
        "Firstname": firstname,
        "Lastname": lastname,
        "Pancard": pancard,
        "MOBILE_NUMBER": "9005797072",
        "MARITAL_STATUS": "S",
        "CROSS_BORDER_RISK": "ZZ",
        "CUSTOMER_TYPE_2": "010203",
        "ISD_CODE": "91"
    }


# Example
entry = generate_cif_entry(123456, "ABC001")
print(entry)